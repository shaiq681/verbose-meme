<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Objective | TestBlogs</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Objective" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="For Blogging…" />
<meta property="og:description" content="For Blogging…" />
<link rel="canonical" href="https://shaiq681.github.io/verbose-meme/2020/06/13/seniment-analysis.html" />
<meta property="og:url" content="https://shaiq681.github.io/verbose-meme/2020/06/13/seniment-analysis.html" />
<meta property="og:site_name" content="TestBlogs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-06-13T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"For Blogging…","url":"https://shaiq681.github.io/verbose-meme/2020/06/13/seniment-analysis.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://shaiq681.github.io/verbose-meme/2020/06/13/seniment-analysis.html"},"headline":"Objective","dateModified":"2020-06-13T00:00:00-05:00","datePublished":"2020-06-13T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/verbose-meme/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://shaiq681.github.io/verbose-meme/feed.xml" title="TestBlogs" /><link rel="shortcut icon" type="image/x-icon" href="/verbose-meme/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/verbose-meme/">TestBlogs</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/verbose-meme/about/">About Me</a><a class="page-link" href="/verbose-meme/search/">Search</a><a class="page-link" href="/verbose-meme/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Objective</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-06-13T00:00:00-05:00" itemprop="datePublished">
        Jun 13, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/shaiq681/verbose-meme/tree/master/_notebooks/2020-06-13-seniment-analysis.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/verbose-meme/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/shaiq681/verbose-meme/master?filepath=_notebooks%2F2020-06-13-seniment-analysis.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/verbose-meme/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/shaiq681/verbose-meme/blob/master/_notebooks/2020-06-13-seniment-analysis.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/verbose-meme/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-06-13-seniment-analysis.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h1><hr />
<ul>
<li><strong>Positive Score</strong>: This score is calculated by assigning the value of +1 for each word if found in the Positive Dictionary and then adding up all the values.</li>
<li><strong>Negative Score</strong>: This score is calculated by assigning the value of -1 for each word if found in the Negative Dictionary and then adding up all the values. We multiply the score with -1 so that the score is a positive number.</li>
<li><strong>Polarity Score</strong>: $\frac{(\text{Positive Score} – \text{Negative Score})}{((\text{Positive Score + Negative Score} ) + 0.000001)}$</li>
<li><strong>Subjective Score</strong>: $\frac{\text{(Positive Score + Negative Score)}}{\text{((Total Words after cleaning) + 0.000001)}}$</li>
<li><strong>Average Sentece Length</strong>: $\frac{\text{No. of Words}}{\text{Np. of Sentences}}$</li>
<li><strong>% Complex Words</strong>: $\frac{\text{The number of complex words}}{\text{The number of words }}$</li>
<li><strong>Fog Index</strong>: $0.4 * \text{(Average Sentence Length + % Complex words)}$</li>
<li><strong>Syllable Count</strong>: Personal Pronouns are considered for counting. Special care is taken so that the country name US is not included in the list.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Libraries">Libraries<a class="anchor-link" href="#Libraries"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span>  <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">glob</span>
<span class="kn">import</span>  <span class="nn">re</span>
<span class="kn">import</span>  <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span>  <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span>  <span class="nn">bs4</span> <span class="k">as</span> <span class="nn">bs</span>
<span class="kn">import</span>  <span class="nn">requests</span> 
<span class="kn">import</span>  <span class="nn">spacy</span> <span class="c1"># NLP</span>
<span class="kn">from</span>    <span class="nn">spacy_syllables</span> <span class="kn">import</span> <span class="n">SpacySyllables</span> <span class="c1"># Syllables</span>
<span class="kn">from</span>    <span class="nn">pathlib</span>     <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span>    <span class="nn">string</span> <span class="kn">import</span> <span class="n">punctuation</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Custom-NLP-Model">Custom NLP Model<a class="anchor-link" href="#Custom-NLP-Model"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nlp</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;en_core_web_sm&#39;</span><span class="p">)</span> <span class="c1"># Custom Model</span>

<span class="n">nlp</span><span class="o">.</span><span class="n">add_pipe</span><span class="p">(</span><span class="s1">&#39;syllables&#39;</span><span class="p">,</span> <span class="n">after</span><span class="o">=</span><span class="s1">&#39;tagger&#39;</span><span class="p">)</span> <span class="c1"># Model for Syllable identification</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;spacy_syllables.SpacySyllables at 0x20bb351fc88&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Constants">Constants<a class="anchor-link" href="#Constants"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">TEXT_LIMIT</span> <span class="o">=</span> <span class="mi">1_000_000</span> <span class="c1"># Default SpaCy limit</span>

<span class="n">URLArchive</span> <span class="o">=</span> <span class="s2">&quot;https://www.sec.gov/Archives/&quot;</span>

<span class="n">CONSTANT</span> <span class="o">=</span> <span class="mf">0.000_001</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Constant-Factory">Constant Factory<a class="anchor-link" href="#Constant-Factory"> </a></h2><ul>
<li>Create List of the following Constants:<ul>
<li>Positive Words </li>
<li>Negative Words</li>
<li>Stop Words(<em>Auditiors</em>, <em>Currencies</em>,<em>Dates and Numbers</em>,<em>Generic</em>, <em>Generic Long</em>, <em>Geographic</em>, <em>Names</em>)</li>
<li>Constraining Words</li>
<li>Uncertainty Words</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="StopWords">StopWords<a class="anchor-link" href="#StopWords"> </a></h2><ul>
<li>Scraped Stopwords from the <a href="https://sraf.nd.edu/textual-analysis/resources/">Official Source</a></li>
<li>Saved Words in the folder <em>SentinemtWordList</em></li>
<li>Collected <strong>positive</strong> and <strong>negative</strong> words for creating a StopWords Corpus.</li>
<li>Used Similar approach to create a corpus of <strong>constraint</strong> and <strong>uncertainty</strong> words.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/*SentimentWordList*&quot;</span><span class="p">))</span> <span class="c1"># Stop Words file Path</span>
<span class="n">sentiment_file</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">/</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">negs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">io</span><span class="o">=</span><span class="n">sentiment_file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Negative&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">io</span><span class="o">=</span><span class="n">sentiment_file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Positive&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">neg_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">negs</span><span class="p">]</span>
<span class="n">pos_words</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">createStopWords</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Function to fetch Stopwords from various stop-words text files as provided in reference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stop_words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pathStopWords</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/stopwords*.txt&quot;</span><span class="p">))</span> <span class="c1"># Stop Words file Path</span>
    <span class="k">if</span> <span class="n">pathStopWords</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">filePath</span> <span class="ow">in</span> <span class="n">pathStopWords</span><span class="p">:</span>
            <span class="n">fullPath</span> <span class="o">=</span>  <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">/</span><span class="n">Path</span><span class="p">(</span><span class="n">filePath</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">TEXT</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">fileStopWOrds</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">TEXT</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)]</span>
                <span class="n">stop_words</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fileStopWOrds</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;StopWords related files are not in the </span><span class="si">{</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="si">}</span><span class="s1"> and its subdirectories&#39;</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">stop_words</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stopWordList</span> <span class="o">=</span> <span class="n">createStopWords</span><span class="p">()</span> <span class="c1"># Collect Stop words from all files</span>
<span class="n">stopWordList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">stopWordList</span><span class="p">))</span> 
<span class="n">nlp</span><span class="o">.</span><span class="n">Defaults</span><span class="o">.</span><span class="n">stop_words</span> <span class="o">-=</span> <span class="n">nlp</span><span class="o">.</span><span class="n">Defaults</span><span class="o">.</span><span class="n">stop_words</span> <span class="c1"># Remove Default Stop Words</span>
<span class="n">nlp</span><span class="o">.</span><span class="n">Defaults</span><span class="o">.</span><span class="n">stop_words</span> <span class="o">=</span> <span class="p">{</span><span class="n">stopword</span> <span class="k">for</span> <span class="n">stopword</span> <span class="ow">in</span> <span class="n">stopWordList</span> <span class="k">if</span> <span class="n">stopword</span> <span class="o">!=</span><span class="s2">&quot;&quot;</span><span class="p">}</span> <span class="c1"># Add custom stop words </span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path_constraint</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/*constraining*&quot;</span><span class="p">))</span> <span class="c1"># Stop Words file Path</span>
<span class="n">constraining_file</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">/</span><span class="n">Path</span><span class="p">(</span><span class="n">path_constraint</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">io</span><span class="o">=</span><span class="n">constraining_file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">]</span>
<span class="c1"># Create Uncertainty List</span>
<span class="n">path_uncertainty</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/*uncertainty*&quot;</span><span class="p">))</span> <span class="c1"># Stop Words file Path</span>
<span class="n">uncertainty_file</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">/</span><span class="n">Path</span><span class="p">(</span><span class="n">path_uncertainty</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">uncertainty</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">io</span><span class="o">=</span><span class="n">uncertainty_file</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">uncertainty</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">uncertainty</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Helper-Functions">Helper Functions<a class="anchor-link" href="#Helper-Functions"> </a></h2><ul>
<li>Performs Data cleaning, formating and NLP tasks.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">replaceHTMLTags</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="s2">&quot;Function that uses Regex to create word tokens.&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&lt;[^&gt;]*&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span> <span class="c1"># Remove HTML Tags</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span> <span class="c1"># Remove Punctuations</span>
    <span class="k">return</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">save_text</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to save the results of the scraped text in &#39;raw&#39; directory.&quot;&quot;&quot;</span>
    <span class="n">file_name</span> <span class="o">=</span>  <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">/</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;raw/&quot;</span><span class="o">+</span><span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Save .txt file in raw folder</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span>  <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Standard Timeout according to SEC.gov</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">status_code</span>
        <span class="k">if</span> <span class="n">response</span> <span class="o">&gt;</span><span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span>  <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># raise ProxyError(&#39;Unable to connect!&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">read_from_txt</span><span class="p">(</span><span class="n">secfname</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to read from the text file related to SECFNAME.</span>
<span class="sd">    Params:</span>
<span class="sd">    ------</span>
<span class="sd">    secfname: str, SECFNAME column value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text_file</span> <span class="o">=</span> <span class="n">secfname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;**/</span><span class="si">{</span><span class="n">text_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">TEXT</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_sentiments</span><span class="p">(</span><span class="n">TEXT</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to get various count in a text.</span>
<span class="sd">    Params:</span>
<span class="sd">    ------</span>
<span class="sd">    TEXT: str, Input text</span>
<span class="sd">    Returns:</span>
<span class="sd">    -------</span>
<span class="sd">    List[count_pos_sents,count_neg_sents, total_complex_words, </span>
<span class="sd">        total_words, total_sents, total_syllables, total_const, total_uncertain]:</span>

<span class="sd">        count_pos_sents: int, No. of Positive words in the SEC Filing</span>
<span class="sd">        count_neg_sents: int, No. of Negative words in the SEC Filing</span>
<span class="sd">        total_complex_words: int, No of Complex words in the SEC Filing</span>
<span class="sd">        total_words: int, Total words post cleanup in the SEC Filing</span>
<span class="sd">        total_sents :  int, Total sentences in the SEC Filing</span>
<span class="sd">        total_syllables: int, Total No of complex Syllables in the SEC Filing</span>
<span class="sd">        total_const: int, Total No of Constraint words</span>
<span class="sd">        total_uncertain: int, Total no. of Uncertain words</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;startint sentiment analysis...&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">TEXT</span><span class="p">:</span>
        <span class="k">return</span><span class="p">([</span><span class="n">CONSTANT</span><span class="p">]</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span> <span class="c1"># To avoid ZeroDivisionError</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span><span class="o">&lt;</span> <span class="n">TEXT_LIMIT</span><span class="p">:</span>
            <span class="n">doc</span>  <span class="o">=</span> <span class="n">nlp</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nlp</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span>
            <span class="n">doc</span>  <span class="o">=</span>  <span class="n">nlp</span><span class="p">(</span><span class="n">TEXT</span><span class="p">,</span> <span class="n">disable</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ner&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;document loaded...&quot;</span><span class="p">)</span>
        
        <span class="n">count_pos_sents</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count_neg_sents</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_complex_words</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_words</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_const</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_uncertain</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">total_sents</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
            <span class="c1"># Positive Word Count</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">lower_</span> <span class="ow">in</span> <span class="n">pos_words</span><span class="p">):</span>
                <span class="n">count_pos_sents</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># Negative Word Count</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">lower_</span> <span class="ow">in</span> <span class="n">neg_words</span><span class="p">):</span>
                <span class="n">count_neg_sents</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="c1"># Complex Word Count</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">syllables_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">token</span><span class="o">.</span><span class="n">_</span><span class="o">.</span><span class="n">syllables_count</span> <span class="o">&gt;</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">total_complex_words</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="c1"># Total Words</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">lower_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nlp</span><span class="o">.</span><span class="n">Defaults</span><span class="o">.</span><span class="n">stop_words</span><span class="p">):</span>
                <span class="n">total_words</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="c1"># Count Constraints</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">lower_</span> <span class="ow">in</span> <span class="n">constraints</span><span class="p">):</span>
                <span class="n">total_const</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="c1"># Count uncertainty</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">lower_</span> <span class="ow">in</span> <span class="n">uncertainty</span><span class="p">):</span>
                <span class="n">total_uncertain</span> <span class="o">+=</span><span class="mi">1</span>
        <span class="c1"># Total Sentences</span>
        <span class="n">total_sents</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">sent</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">sents</span><span class="p">)</span>
        <span class="k">return</span><span class="p">([</span><span class="n">count_pos_sents</span><span class="p">,</span><span class="n">count_neg_sents</span><span class="p">,</span> <span class="n">total_complex_words</span><span class="p">,</span> 
        <span class="n">total_words</span><span class="p">,</span> <span class="n">total_sents</span><span class="p">,</span>  <span class="n">total_const</span><span class="p">,</span> <span class="n">total_uncertain</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Loading">Data Loading<a class="anchor-link" href="#Data-Loading"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;cik_list.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;cik_list_ajay&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Text-Mining-Pipeline">Text Mining Pipeline<a class="anchor-link" href="#Text-Mining-Pipeline"> </a></h2><hr />
<ul>
<li>Reads the TEXT file into the SpaCy's vectorized format.</li>
<li>Removes possible HTML related tags and punctuations.</li>
<li>Performs Sentiment analysis: calculates, positive, negative and polarity score</li>
<li>Calculates Complex Word count</li>
<li>Calculates Total Word count</li>
<li>Calculates Uncertainty count</li>
<li>Calculates Constraining count.</li>
<li>Retuns results as pandas columns</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text_mining_pipeline</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">secfname</span><span class="p">:</span> <span class="n">get_sentiments</span><span class="p">(</span><span class="n">replaceHTMLTags</span><span class="p">(</span><span class="n">read_from_txt</span><span class="p">(</span><span class="n">secfname</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Uncertainity Score and Constraining Score</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;positive_score&#39;</span><span class="p">,</span><span class="s1">&#39;negative_score&#39;</span><span class="p">,</span><span class="s1">&#39;complex_word_count&#39;</span><span class="p">,</span><span class="s1">&#39;word_count&#39;</span><span class="p">,</span><span class="s1">&#39;sentence_length&#39;</span><span class="p">,</span>\
    <span class="s1">&#39;uncertainty_score&#39;</span><span class="p">,</span> <span class="s1">&#39;constraining_score&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">text_mining_pipeline</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;SECFNAME&#39;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>startint sentiment analysis...
document loaded...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
document loaded...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
document loaded...
startint sentiment analysis...
document loaded...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
document loaded...
startint sentiment analysis...
document loaded...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
document loaded...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
document loaded...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
startint sentiment analysis...
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;polarity_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;positive_score&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;negative_score&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;positive_score&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;negative_score&#39;</span><span class="p">]</span><span class="o">+</span> <span class="n">CONSTANT</span><span class="p">)</span> <span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;average_sentence_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;word_count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;sentence_length&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;percentage_of_complex_words&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span>\
    <span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;complex_word_count&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;word_count&#39;</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;fog_index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span><span class="o">*</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;average_sentence_length&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;percentage_of_complex_words&#39;</span><span class="p">])</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;positive_word_proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;positive_score&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;word_count&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;negative_word_proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;negative_score&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;word_count&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;uncertainty_word_proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;uncertainty_score&#39;</span><span class="p">]</span><span class="o">/</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;word_count&#39;</span><span class="p">]</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;constraining_word_proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;constraining_score&#39;</span><span class="p">]</span><span class="o">/</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;word_count&#39;</span><span class="p">]</span> <span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;constraining_words_whole_report&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">constraining_score</span><span class="p">)</span> <span class="c1"># Broadcasting the total constraining score of all the docs.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data-Saving">Data Saving<a class="anchor-link" href="#Data-Saving"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">path_or_buf</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">/</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;result.csv&#39;</span><span class="p">),</span>
<span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CIK&#39;</span><span class="p">,</span> <span class="s1">&#39;CONAME&#39;</span><span class="p">,</span> <span class="s1">&#39;FYRMO&#39;</span><span class="p">,</span> <span class="s1">&#39;FDATE&#39;</span><span class="p">,</span> <span class="s1">&#39;FORM&#39;</span><span class="p">,</span> <span class="s1">&#39;SECFNAME&#39;</span><span class="p">,</span> <span class="s1">&#39;positive_score&#39;</span><span class="p">,</span> \
    <span class="s1">&#39;negative_score&#39;</span><span class="p">,</span> <span class="s1">&#39;polarity_score&#39;</span><span class="p">,</span> <span class="s1">&#39;average_sentence_length&#39;</span><span class="p">,</span> <span class="s1">&#39;percentage_of_complex_words&#39;</span><span class="p">,</span> <span class="s1">&#39;fog_index&#39;</span><span class="p">,</span>\
        <span class="s1">&#39;complex_word_count&#39;</span><span class="p">,</span> <span class="s1">&#39;word_count&#39;</span><span class="p">,</span> <span class="s1">&#39;uncertainty_score&#39;</span><span class="p">,</span> <span class="s1">&#39;constraining_score&#39;</span><span class="p">,</span> <span class="s1">&#39;positive_word_proportion&#39;</span><span class="p">,</span>\
            <span class="s1">&#39;negative_word_proportion&#39;</span><span class="p">,</span> <span class="s1">&#39;uncertainty_word_proportion&#39;</span><span class="p">,</span> <span class="s1">&#39;constraining_word_proportion&#39;</span><span class="p">,</span> <span class="s1">&#39;constraining_words_whole_report&#39;</span><span class="p">],</span>
            <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/verbose-meme/2020/06/13/seniment-analysis.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/verbose-meme/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/verbose-meme/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/verbose-meme/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>For Blogging...</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/verbose-meme/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/verbose-meme/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
